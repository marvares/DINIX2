---
title: "Informe Estandarizaci贸n Per煤 Escala INDI, Parte 4: An谩lisis de Regresi贸n"
subtitle: "Muestra Nivel 3"
author: "Mart铆n Vargas Estrada"
date: "`r Sys.time()`"
output:
  pdf_document:
    toc: true
    toc_depth: 4
  word_document:
    toc: true
    toc_depth: '4'
  html_document:
    toc: true
    toc_depth: '4'
    df_print: paged
header-includes: \renewcommand{\contentsname}{ndice} \renewcommand{\tablename}{Tabla}
---
\newpage

# Introducci贸n


Informe de Exploraci贸n Psicom茅trica de los 铆tems de la prueba INDI obtenidas con muestra de Per煤, Nivel 3. 

```{r 30_P4_DATAFRAME, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, results='asis'}

library(tidyverse)
library(haven)
rm(list = ls()) 
# Carga el archivo .sav
INDI30 <- read_sav("INDI3.sav")
# Invertir los 铆tems
invertir_y_sumar <- function(df, indices_inversos, nombre_variable_sumatoria, posicion_variable) {
  
  # Asegurar que df sea un tibble para evitar problemas con select()
  df <- as_tibble(df)
  
  # 1. Convertir columnas 75:88 a num茅ricas
  df <- df %>%
    mutate(across(74:86, as.numeric))
  
  # 2. Invertir los 铆tems indicados
  df <- df %>%
    mutate(across(indices_inversos, ~ 7 - .x))
  
  # 3. Crear la variable sumatoria
  df <- df %>%
    mutate(!!nombre_variable_sumatoria := rowSums(across(74:86)))
  
  # 4. Reubicar la variable sumatoria en la posici贸n deseada
  col_order <- names(df)  # Obtener nombres de columnas
  col_order <- setdiff(col_order, nombre_variable_sumatoria)  # Remover sumatoria si ya est谩
  col_order <- append(col_order, nombre_variable_sumatoria, after = posicion_variable - 1)  # Insertar en posici贸n
  
  #  Reordenar usando 铆ndice de columnas en lugar de dplyr::select()
  df <- df[, col_order]  # 猬锔 Esto funciona siempre

  return(df)
}

# Aplicar la funci贸n con los valores indicados
INDI30_i <- invertir_y_sumar(
  df = INDI30,
  indices_inversos = c(76:79, 83:86),  # tems inversos
  nombre_variable_sumatoria = "S_sum",  # Nombre de la variable sumatoria
  posicion_variable = 102  # Ubicaci贸n deseada
)
```


# An谩lisis de Regresi贸n entre el valor de las Escalas  y las Variables Demogr谩ficas

## Introducci贸n 

El objetivo de esta secci贸n realizar un an谩lisis de regresi贸n entre el valor de las escalas y las diferentes variables demogr谩ficas cuya informaci贸n fue recabada durante la investigaci贸n. 

Cabe especificar el sentido del an谩lisis de regresi贸n, ya que, a diferencia de los anteriores, es f谩cil malentenderlo y su significado no es evidente a primera vista.

El objetivo del an谩lisis de regresi贸n es encontrar una relaci贸n de causalidad entre una o m谩s variables independientes, y una variable dependiente. Esta 煤ltima es la "estrella" de nuestro an谩lisis; en contra de lo que pudiera parecer, la variable dependiente es en realidad la principal, la que motiva toda la pesquisa estad铆stica. Estamos interesados determinar si ciertas variables pueden ayudarnos a explicar y/o predecir a nuestra variable dependiente. 

Una variable es "independiente" en el sentido de que, dentro de nuestra teor铆a y/o nuestro sentido com煤n, ciertas variables podr铆an causar o predecir a nuestra variable dependiente, y esta relaci贸n, te贸ricamente, deber铆a ser unidireccional. Por ejemplo, cuando decimos que la *variable independiente* es la Edad del participante y nuestra *variable dependiente* es el puntaje en la escala Cognitiva del INDI, estamos planteando la posibilidad de que la edad nos ayude a explicar y/o predecir el desempe帽o en el INDI, y plantearnos una relaci贸n inversa (驴el puntaje influenciando a la Edad?) o incluso rec铆proca (驴Edad y desempe帽o en el INDI influenci谩ndose mutuamente?) no tendr铆a sentido. 

A veces, la l贸gica la define nuestro sentido com煤n (claramente la edad, por definici贸n, no es influenciada por ning煤n tipo de acci贸n del participante); a veces es determinada por la teor铆a que nos gu铆a para plantear toda la investigaci贸n en primer lugar. 

## Interpretaci贸n General de los Resultados de la Regresi贸n

1. **Qu茅 es la ecuaci贸n de regresi贸n**. En primer lugar, es importante entender cu谩l es el sentido de la regresi贸n. Recordemos que nuestro prop贸sito es explicar/predecir los valores de una variable dependiente a partir de variables independientes. Explicar significa en este caso definir una ecuaci贸n que describa el comportamiento de la variable dependiente. En esa ecuaci贸n la variable dependiente ser谩 el resultado (es decir, ir谩 antes del signo "=") y las variables independientes ser谩n los sumandos que al agregarse resultan en el valor que la variable dependiente tomar谩 seg煤n el caso.

En t茅rminos matem谩ticos:

$$ Y=\beta_0+\beta_1X_1+\beta_2X_2+\ldots+\beta_nX_n $$
Cada valor $X$ representa una variable (num茅rica o categ贸rica), y cada valor $\beta$ un coeficiente que pondera el valor que cada variable asume para poder as铆 determinar un valor dado que asumir谩 la variable dependiente $Y$. El sub铆ndice se usa para especificar que el coeficiente ser谩 distinto para cada variable independiente.

El coeficiente $\beta_0$ es lo que se llama *intercepto*; es el valor que asume la variable dependiente cuando todas las variables independientes asumen un valor cero. 

2. **Qu茅 significan las variables *dummy* en el contexto del tratamiento estad铆stico de la regresi贸n**. Cada vez que incluimos una variable categ贸rica (es decir, una variable cuyos valores no son num茅ricos, sino m谩s bien categor铆as; ejemplo: Regi贸n, cuyos valores ser铆an las categor铆as "Costa", "Sierra", y "Selva"), nos vemos obligados a utilizar un algoritmo que nos permita incluir esas variables en el c谩lculo. Ese algoritmo o m茅todo consiste en asumir como referencia la primera categor铆a de la variable, y luego pasar a incluir las dem谩s categor铆as como si se tratase de variables distintas, convirti茅ndolas en variable dicot贸micas.

En el caso de nuestro ejemplo, si nuestra variable es "Regi贸n", y las categor铆as son Costa, Sierra y Selva, entonces podemos asumir la categor铆a "Costa" como valor de referencia; cuando un participante pertenezca a la Regi贸n "Sierra", lo traduciremos en t茅rminos de variables *dummy* como un "1" en la variable *Regi贸nSierra*. Si el participante no pertenece a la la Regi贸n Sierra, tendr谩 un "0" en la variable *Regi贸nSierra*. Igual haremos con todos los dem谩s casos de variables categ贸ricas. 

Esto tiene una enorme ventaja: nos permite tratar a las variables categ贸ricas como si fueran variables dicot贸micas num茅ricas, haciendo posible incluirlas en la ecuaci贸n de regresi贸n. Pero tiene una gran desventaja: nos obliga a tener mucho cuidado al momento de interpretar la ecuaci贸n. 

Pongamos un ejemplo para clarificar: imaginemos que estamos tratando de explicar la variable Escala Cognitiva a partir de la variable Edad y la variable Regi贸n. Es decir, 

$$ Y=EscalaCognitiva, X_1=Edad, X_2=Regi贸n $$
Con la variable Edad no tendremos problema porque se trata de una variable num茅rica. No es el caso con la variable Regi贸n. Tomaremos la categor铆a "Costa" como referencia; por lo tanto, cuando tengamos un participante de la Costa sencillamente tomaremos el valor del intercepto ($\beta_0$) como el aporte de la variable *Regi贸nCosta*. Si el participante proviene, por el contrario, de la Sierra, entonces tendremos que la variable Regi贸nSierra=1, y la variable Regi贸nSelva=0. Todas las variables independientes con valor cero ser谩n eliminadas de la ecuaci贸n porque tendr谩n valor nulo, y solo quedar谩n las variables independientes con valor distinto de cero. Para fines de nuestro ejemplo, asumamos que:

$$ 
\beta_0=1.2; \beta_1=0.9; X_1=Edad; \beta_2=2.7; X_2=RegionSierra; \beta_3=4.1; X_3=RegionSelva
$$


Por lo tanto, nuestra ecuaci贸n de regresi贸n quedar谩 como sigue:

$$ EscalaCognitiva = 1.2 + 0.9*Edad + 2.7*RegionSierra + 4.1*RegionSelva $$
Si un participante pertenece a la Regi贸n Costa y tiene una edad de 40 meses, entonces nuestro modelo predice que:

$$ EscalaCognitiva = 1.2 + 0.9*40 + 2.7*0 + 4.1*0 $$
Es decir, 

$$ EscalaCognitiva = 37.2 $$

### Regresi贸n y Correlaci贸n 

La diferencia clave entre la regresi贸n y la correlaci贸n es que, mientras la correlaci贸n solo mide asociaci贸n entre variables, la regresi贸n trata de determinar la *causalidad* de una o m谩s variables (llamadas independientes) sobre otra (llamada dependiente).

Otra diferencia importante es que mientras la correlaci贸n solo describe la asociaci贸n o co-ocurrencia entre dos variables, *la regresi贸n est谩 dise帽ada de tal modo que nos ayuda a determinar en qu茅 medida una variable independiente explica el comportamiento de la dependiente*. Como luego veremos, es completamente posible, como resultado de un an谩lisis de regresi贸n, establecer en qu茅 porcentaje una variable independiente X nos ayuda a explicar el comportamiento o variabilidad de los datos de una variable dependiente.

Finalmente, una tercera distinci贸n fundamental es que mientras que la correlaci贸n se limita *describir* la co-ocurrencia de dos conjuntos de datos ya existentes, el an谩lisis de regresi贸n nos permite *predecir* valores de la variable dependiente a partir de valores de las variables independientes, *incluso si tales valores no se dan en nuestra muestra*. 

### Regresi贸n como descriptor de una relaci贸n lineal

Antes de pasar a ver los resultados, debemos tener en cuenta que el tipo de an谩lisis de regresi贸n que pasaremos a ejecutar se basa en el supuesto de que existe una relaci贸n lineal entre el conjunto de variables independientes y los puntajes en las escalas INDI. Es decir, que el efecto de las variables independientes es constante, va en una sola direcci贸n y no cambia de sentido. Por ejemplo,  si asumimos una relaci贸n lineal entre Edad en Meses y Puntaje en el INDI, estaremos asumiendo que el aumento de un mes en la Edad mejorar谩 el desempe帽o en el INDI, y esto no cambiar谩 y adem谩s es constante (el incremento de un mes en la edad deber铆a tener el mismo efecto en el puntaje, sin importar la edad del participante).

Es posible que la relaci贸n entre una variable dependiente y una o m谩s variables independientes sea no lineal; en ese caso, el resultado de una regresi贸n lineal ser谩 nulo, sin que esto necesariamente implique falta de relaci贸n en general. Tan solo estar铆amos hablando de falta de relaci贸n *lineal*. 

Habiendo dicho esto, por lo general la regresi贸n lineal es la que se analiza, ya que se trata del modelo m谩s frecuente y sencillo de entender y de evaluar. Salvo que nuestra teor铆a establezca lo contrario, ser谩 el tipo de regresi贸n que usaremos. 


## Variables Demogr谩ficas Consideradas (Variables Independientes)

Consideraremos las siguientes variables:

1. Edad en Meses
1. Fecha de Eval
1. Regi贸n
1. rea
1. Modalidad
1. Gesti贸n
1. Departamento
1. Quintil
1. Inst. Previa al Nivel 3

```{r 30_P4_DATAFRAMING, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, results='asis'}



# Funci贸n para extraer la data num茅rica sin NA's de un df
ayudin <- function(dataframe, columnas) {
  # Verificar que las columnas seleccionadas sean num茅ricas
  if (!all(sapply(columnas, function(col) is.numeric(dataframe[[col]])))) {
    stop("Todas las columnas seleccionadas deben ser num茅ricas.")
  }
  
  # Filtrar el dataframe eliminando filas con NA en las columnas seleccionadas
  dataframe_limpio <- dataframe[complete.cases(dataframe[, columnas]), columnas]
  
  # Devolver el dataframe limpio
  return(dataframe_limpio)
}

# Llamar a la funci贸n y mostrar los resultados
INDI30_i$Codigo <- as.numeric(INDI30_i$Codigo)
LIMPIO <- ayudin(dataframe = INDI30_i, columnas = c(1, 100:103))

# DF Categorial
# Funci贸n para convertir variables a factor
convert_to_factor <- function(df, indices) {
  df[indices] <- lapply(df[indices], as.factor)
  return(df)
}
# Convierto a factor

INDI30_Factor<- convert_to_factor(INDI30_i, c(5,7:9,11,13,41))
# Me quedo solo con las variables factor
library(dplyr)
INDI30_Factor <- INDI30_Factor %>% 
  dplyr::select(Codigo, EDADMES, Regnat, Area, Nivmod, Reg, Quintil, Insant3a)
# Fusiono con el df num茅rico sin NA's
PULCRO <- left_join(LIMPIO, INDI30_Factor,  by = "Codigo") # Este df solo tiene casos sin NA's y con las variables factor

# Ahora voy a reetiquetar los niveles de los factores y, de ser caso, rebautizarlos.

library(forcats)
# Recodificar niveles
# PULCRO$Fechin <- fct_recode(PULCRO$Fechin,
#                         "Abr." = "2024-04-29",
#                         "May." = "2024-05-20",
#                         "Jun." = "2024-06-17",
#                         "Ago." = "2024-08-12")
PULCRO$Regnat<- fct_recode(PULCRO$Regnat,
                        "Costa" = "1",
                        "Sierra" = "2",
                        "Selva" = "3")

PULCRO$Area <- fct_recode(PULCRO$Area,
                        "Urbana" = "1",
                        "Rural" = "2")

PULCRO$Nivmod <- fct_recode(PULCRO$Nivmod,
                        "Jard铆n" = "Inicial - Jard铆n",
                        "No_Esc" = "Inicial - Programa no escolarizado",
                        "Cuna-Jard铆n" = "Inicial - Cuna-jard铆n"
                        )
# PULCRO$Gest <- fct_recode(PULCRO$Gest,
#                         "P煤blica" = "1",
#                         "Privada" = "2")
PULCRO$Reg <- fct_recode(PULCRO$Reg,
                        "Lima Met." = "Lima Metropolitana",
                        "Piura" = "Piura",
                        "Cusco" = "Cusco",
                        "Loreto" = "Loreto"
                        )

colnames(PULCRO) <- c("C贸digo", "Escala_Cog.", "Escala_Mot.", "Escala_Soc", "Escala_Dis.","Edad_Mes", "Regi贸n", "rea", "Modalidad", "Departamento", "Quintil", "Inst_Pre_N3")

# PULCRO$Inst_Mat. <- fct_relevel(PULCRO$Inst_Mat., "Ninguno", "Inicial", "Primaria incompleto", "Primaria completo", "Secundaria incompleto", "Secundaria completo","Superior t茅cnico incompleto", "Superior t茅cnico completo","Superior universitario incompleto","Superior universitario completo","Posgrado (maestr铆a, doctorado)")
# 
# PULCRO$Inst_Pat. <- fct_relevel(PULCRO$Inst_Pat., "Ninguno", "Inicial", "Primaria incompleto", "Primaria completo", "Secundaria incompleto", "Secundaria completo","Superior t茅cnico incompleto", "Superior t茅cnico completo","Superior universitario incompleto","Superior universitario completo","Posgrado (maestr铆a, doctorado)")

PULCRO$Inst_Pre_N3  <- fct_recode(PULCRO$Inst_Pre_N3,
                        "No" = "0",
                        "S铆" = "1",
                        "NS/NR" = "2"
                        )

# Filtro los casos de Modalidad No escolarizada, al ser un grupo demasiado peque帽o
PULCRO <- PULCRO %>% 
  filter(Modalidad != "No_Esc")
# Como hay colinearidad Perfecta entre Fecha_Eval y Dpto, elimino Fecha Eval
# PULCRO <- PULCRO %>% select(-Fecha_Eval)

```

Las variables dicot贸micas de Incidencia (codificadas como VSS y similares) y Tratamiento (RSS y similares) no fueron consideradas para este an谩lisis, ya que definen subgrupos extremadamente peque帽os (menos del 5%,; en la mayor铆a de casos, menos del 3%) y tomarlas en cuenta distorsionar铆a los resultados, al obligar a tomar medidas de ajuste que a su vez introducir铆an nuevos sesgos. Lo mismo sucede con los casos de la variable Gesti贸n, y el peque帽o grupo perteneciente a la categor铆a "No escolarizado" dentro de la variable "Modalidad".

\newpage

## An谩lisis 1: Escala Cognitiva como Variable Dependiente

A continuaci贸n determinaremos qu茅 tan 煤til es un an谩lisis de regresi贸n para intentar explicar/predecir los puntajes en la escala Cognitiva del INDI a partir de las variables independientes ya mencionadas.  




```{r 30_P4_REG_CSUM, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, results='asis'}

# Defino s煤per funci贸n que me bota los resultados de la regresi贸n m煤ltiple en formato PTM
regmulti <- function(df, var_dep, var_ind, nombres_vars = NULL, nombre_dep = NULL) {
  library(knitr)  # Para kable
  library(dplyr)  # Para manipulaci贸n de datos
  
  # Obtener el nombre original de la variable dependiente
  var_dep_name <- deparse(substitute(var_dep))
  
  # Si el usuario proporciona un nombre para la variable dependiente, usarlo
  if (is.null(nombre_dep)) {
    nombre_dep <- var_dep_name
  }
  
  # Extraer nombres originales de las variables independientes
  nombres_ind <- names(df)[var_ind]
  
  # Si el usuario proporciona nombres personalizados, validamos que sean del mismo tama帽o
  if (!is.null(nombres_vars)) {
    if (length(nombres_vars) != length(nombres_ind)) {
      stop("El n煤mero de nombres en 'nombres_vars' debe coincidir con el n煤mero de variables independientes proporcionadas.")
    }
  } else {
    nombres_vars <- nombres_ind  # Usar los nombres originales si no se proporcionan personalizados
  }
  
  # Construcci贸n de la f贸rmula de regresi贸n
  formula_reg <- as.formula(paste(var_dep_name, "~", paste(nombres_ind, collapse = " + ")))
  
  # Ajustar el modelo de regresi贸n
  modelo <- lm(formula_reg, data = df)
  
  # Obtener coeficientes y p-valores
  resultados <- summary(modelo)$coefficients
  coeficientes <- resultados[, 1]
  p_valores <- resultados[, 4]
  
  # Obtener nombres de los coeficientes generados (incluye dummies)
  nombres_coeficientes <- rownames(resultados)
  
  # Construcci贸n autom谩tica de nombres personalizados si hay variables categ贸ricas
  if (!is.null(nombres_vars)) {
    # Crear un mapeo entre nombres originales y personalizados
    nombres_dict <- setNames(nombres_vars, nombres_ind)
    
    # Reemplazar nombres en coeficientes, conservando variables dummy
    nombres_coeficientes <- sapply(nombres_coeficientes, function(var) {
      for (orig in nombres_ind) {
        if (grepl(orig, var)) {
          return(gsub(orig, nombres_dict[[orig]], var))
        }
      }
      return(var)  # Si no se encuentra en el diccionario, mantener el nombre original
    })
  }
  
  # Asignar notaci贸n de significancia
  significancia <- ifelse(p_valores < 0.001, "***",
                          ifelse(p_valores < 0.01, "**",
                                 ifelse(p_valores < 0.05, "*", "NS")))
  
  # Crear la tabla de resultados
  tabla_resultados <- tibble::tibble(
    Variable = nombres_coeficientes,
    Coeficiente = round(coeficientes, 3),
    `p-valor` = round(p_valores, 4),
    Significancia = significancia
  )
  
  # ---- Construcci贸n de la ecuaci贸n de regresi贸n con t茅rminos significativos ----
  # Seleccionamos solo coeficientes con p-valor < 0.05 (significativos)
  indices_significativos <- which(p_valores < 0.05)
  
  # Si solo el intercepto es significativo, ecuaci贸n ser谩 solo ese valor
  if (length(indices_significativos) == 1 && indices_significativos == 1) {
    ecuacion <- paste0(nombre_dep, " = ", round(coeficientes[1], 3), " + 蔚")
  } else {
    coef_significativos <- coeficientes[indices_significativos]
    nombres_significativos <- nombres_coeficientes[indices_significativos]
    
    terminos <- paste0(
      ifelse(coef_significativos[-1] >= 0, "+ ", "- "), abs(round(coef_significativos[-1], 3)), " * ", nombres_significativos[-1]
    )
    
    ecuacion <- paste0(
      nombre_dep, " = ", round(coef_significativos[1], 3), " ",
      paste(terminos, collapse = " ")
    )
  }
  
  # Obtener el R虏 ajustado
  r_cuadrado_ajustado <- round(summary(modelo)$adj.r.squared, 4)
  
  # ---- Imprimir resultados ----
  cat("\n### Regresi贸n entre", nombre_dep, "y", paste(nombres_vars, collapse = ", "), "\n")
  print(kable(tabla_resultados, format = "markdown", align = "c"))
  cat("\n**La ecuaci贸n de regresi贸n obtenida es (solo coeficientes significativos):**\n\n", ecuacion, "\n")
  cat("\n**R Cuadrado Ajustado:**", r_cuadrado_ajustado, "\n")
}
PULCRO$Edad_Mes <- as.numeric(PULCRO$Edad_Mes)
# La uso, muy quitado de la pena:
regmulti(PULCRO, PULCRO$Escala_Cog., c(6:12), nombres_vars = c("Edad en Meses", "Regi贸n", "rea", "Modalidad", "Departamento", "Quintil", "Instrucci贸n Previa"), nombre_dep = "Escala Cognitiva")

```

La informaci贸n anterior nos indica que:

1. Usar todas las variables que hemos recolectado para predecir el puntaje en la Escala Cognitiva del INDI nos genera un modelo que puede explicar casi el 40% de la variabilidad de los datos. 
1. Las 煤nicas variables que realmente aportan a la explicaci贸n del puntaje en la Escala Cognitiva INDI son: 
  
  a. Edad
  a. Departamento (Lima)
  a. Regi贸n Selva
  a. Que el participante haya tenido Instrucci贸n previa la Nivel 3
  a. Que el participante no pueda determinar si tuvo Instrucci贸n previa la Nivel 3
  

\newpage

## An谩lisis 2: Escala Motora como Variable Dependiente

A continuaci贸n determinaremos qu茅 tan 煤til es un an谩lisis de regresi贸n para intentar explicar/predecir los puntajes en la escala Motora del INDI a partir de las variables independientes ya mencionadas.  

```{r 30_P4_REG_MSUM, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, results='asis'}
regmulti(PULCRO, PULCRO$Escala_Mot., c(6:12), nombres_vars = c("Edad en Meses", "Regi贸n", "rea", "Modalidad", "Departamento", "Quintil", "Instrucci贸n Previa"), nombre_dep = "Escala Motora")
```

La informaci贸n anterior nos indica que:

1. Usar todas las variables que hemos recolectado para predecir el puntaje en la Escala Motora del INDI nos genera un modelo que solo puede explicar menos del 24% de la variabilidad de los datos. Esto significa que m谩s del 76% del comportamiento de la Escala Motora del INDI se debe a factores no considerados dentro de este estudio. 
1. Las 煤nicas variables que realmente aportan a la explicaci贸n del puntaje en la Escala Motora INDI son: 
  
  a. Edad
  a. Departamento (Lima)
  a. Que el participante provenga del Quintil 5
  a. Que el participante haya tenido Instrucci贸n previa la Nivel 3


\newpage


## An谩lisis 3: Escala Socioemocional como Variable Dependiente

A continuaci贸n determinaremos qu茅 tan 煤til es un an谩lisis de regresi贸n para intentar explicar/predecir los puntajes en la escala Socioemocional del INDI a partir de las variables independientes ya mencionadas.  

```{r 30_P4_REG_SSUM, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, results='asis'}
regmulti(PULCRO, PULCRO$Escala_Soc, c(6:12), nombres_vars = c("Edad en Meses", "Regi贸n", "rea", "Modalidad", "Departamento", "Quintil", "Instrucci贸n Previa"), nombre_dep = "Escala Socioemocional")
```

La informaci贸n anterior nos indica que:

1. El R虏 ajustado = 0.1132 sugiere que el modelo explica aproximadamente el 11.3% de la variabilidad en la escala socioemocional. Esto indica que hay otros factores no incluidos en el modelo que tambi茅n influyen en los puntajes.

1. Se encontraron algunas variables significativas, lo que sugiere que ciertos factores como el tipo de 谩rea (rural/urbana), la modalidad educativa, el departamento de residencia y el nivel socioecon贸mico (quintil) tienen impacto en el desarrollo socioemocional.

1. Los ni帽os de zonas rurales tienen un menor desarrollo socioemocional en comparaci贸n con los de zonas urbanas, lo que sugiere desigualdades en el acceso a est铆mulos y oportunidades de socializaci贸n.

1. Asistir a un jard铆n de infancia mejora significativamente el desarrollo socioemocional, destacando la importancia de la educaci贸n preescolar estructurada.

1. Lima Metropolitana y Loreto tienen puntajes m谩s altos en la Escala Socioemocional, posiblemente debido a diferencias en acceso a servicios educativos y sociales.

1. Los ni帽os del segundo quintil socioecon贸mico tienen un mejor desarrollo socioemocional que los del primer quintil, lo que sugiere que la pobreza extrema puede ser un factor limitante.

1. La categor铆a NS/NR en instrucci贸n previa muestra un efecto positivo, lo que podr铆a indicar que existen caracter铆sticas en este grupo que favorecen el desarrollo socioemocional.


\newpage


## An谩lisis 4: Escala Disposicional como Variable Dependiente

A continuaci贸n determinaremos qu茅 tan 煤til es un an谩lisis de regresi贸n para intentar explicar/predecir los puntajes en la escala Motora del INDI a partir de las variables independientes ya mencionadas.  

```{r 30_P4_REG_DSUM, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, results='asis'}
regmulti(PULCRO, PULCRO$Escala_Dis., c(6:12), nombres_vars = c("Edad en Meses", "Regi贸n", "rea", "Modalidad", "Departamento", "Quintil", "Instrucci贸n Previa"), nombre_dep = "Escala Disposicional")
```

La informaci贸n anterior nos indica que:

1. Usar todas las variables que hemos recolectado para predecir el puntaje en la Escala Disposicional del INDI nos genera un modelo que solo puede explicar algo m谩s del 20% de la variabilidad de los datos. Esto significa que casi el 80% del comportamiento de la Escala Disposicional del INDI se debe a factores no considerados dentro de este estudio. 
1. Las 煤nicas variables medidas que realmente aportan a la explicaci贸n del puntaje en la Escala Cognitiva INDI son: 
  
  a. Edad
  a. Regi贸n Selva
  a. Que el participante provenga de la Regi贸n Rural (en detrimento)
  a. Que el participante provenga de Lima
  a. Quintil (todos)
  a. Que el participante haya tenido Instrucci贸n previa la Nivel 3
  a. Que el participante no pueda determinar si tuvo Instrucci贸n previa la Nivel 3
  





  